// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`should collect data 1`] = `
Object {
  "collectedEntities": Array [
    Object {
      "_class": Array [
        "Account",
      ],
      "_key": "fastly-account:6Bfjl1cR8HV2hPuQykFxJa",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "billing_contact_id": null,
            "billing_network_type": "public",
            "billing_ref": null,
            "can_configure_wordpress": false,
            "can_reset_passwords": true,
            "can_upload_vcl": true,
            "created_at": "2020-08-27T13:32:45Z",
            "deleted_at": null,
            "force_2fa": false,
            "force_sso": false,
            "has_account_panel": true,
            "has_api_key": false,
            "has_improved_events": false,
            "has_improved_ssl_config": false,
            "has_openstack_logging": true,
            "has_pci": false,
            "has_pci_passwords": false,
            "id": "6Bfjl1cR8HV2hPuQykFxJa",
            "ip_whitelist": "0.0.0.0/0",
            "logentries_provisioned_by": null,
            "max_tokens_per_user": 100,
            "name": "JupiterOne",
            "owner_id": "1hJNx2XBX94T64w931jVBp",
            "phone_number": "9195228915",
            "postal_address": null,
            "pricing_plan": "developer",
            "pricing_plan_id": "6HW4welznAHVnMCJhY9QdX",
            "rate_limit": 1000,
            "readonly": false,
            "requires_support_email": false,
            "san_domains": 5,
            "updated_at": "2020-08-27T13:32:45Z",
          },
        },
      ],
      "_type": "fastly_account",
      "address": null,
      "createdOn": 1598535165000,
      "deletedOn": undefined,
      "displayName": "JupiterOne",
      "id": "6Bfjl1cR8HV2hPuQykFxJa",
      "ipWhitelist": "0.0.0.0/0",
      "mfaEnabled": false,
      "mfaEnforced": false,
      "name": "JupiterOne",
      "ownerId": "1hJNx2XBX94T64w931jVBp",
      "phone": "9195228915",
      "rateLimit": 1000,
      "readOnly": false,
      "ssoEnforced": false,
      "updatedOn": 1598535165000,
    },
    Object {
      "_class": Array [
        "User",
      ],
      "_key": "fastly-user:1hJNx2XBX94T64w931jVBp",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "created_at": "2020-08-27T13:32:45Z",
            "customer_id": "6Bfjl1cR8HV2hPuQykFxJa",
            "deleted_at": null,
            "email_hash": "c60680fa19ac66cbb41f6898b99bd367",
            "id": "1hJNx2XBX94T64w931jVBp",
            "limit_services": false,
            "locked": false,
            "login": "erkang.zheng@jupiterone.com",
            "name": "Erkang Zheng",
            "require_new_password": false,
            "role": "superuser",
            "two_factor_auth_enabled": false,
            "two_factor_setup_required": false,
            "updated_at": "2020-08-27T13:34:47Z",
          },
        },
      ],
      "_type": "fastly_user",
      "active": true,
      "admin": true,
      "createdOn": 1598535165000,
      "deletedOn": undefined,
      "displayName": "Erkang Zheng",
      "id": "1hJNx2XBX94T64w931jVBp",
      "locked": false,
      "login": "erkang.zheng@jupiterone.com",
      "mfaEnabled": false,
      "mfaSetupRequired": false,
      "name": "Erkang Zheng",
      "role": "superuser",
      "updatedOn": 1598535287000,
      "username": "erkang.zheng@jupiterone.com",
    },
    Object {
      "_class": Array [
        "AccessKey",
      ],
      "_key": "fastly-api-token:4sPcKZXcDLkMy3aoVwWeqT",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "created_at": "2020-08-27T13:35:02Z",
            "customer_id": "6Bfjl1cR8HV2hPuQykFxJa",
            "expires_at": null,
            "id": "4sPcKZXcDLkMy3aoVwWeqT",
            "ip": "99.29.119.164",
            "last_used_at": "2020-08-28T21:32:03Z",
            "name": "manage.fastly.com browser session",
            "scope": "global",
            "scopes": Array [
              "global",
            ],
            "service_id": null,
            "services": Array [],
            "sudo_expires_at": null,
            "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36",
            "user_id": "1hJNx2XBX94T64w931jVBp",
          },
        },
      ],
      "_type": "fastly_api_token",
      "createdOn": 1598535302000,
      "displayName": "manage.fastly.com browser session",
      "expiresOn": undefined,
      "id": "4sPcKZXcDLkMy3aoVwWeqT",
      "ip": "99.29.119.164",
      "lastUsedAt": "99.29.119.164",
      "lastUsedBy": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36",
      "lastUsedOn": 1598650323000,
      "name": "manage.fastly.com browser session",
      "scope": "global",
      "scopes": Array [
        "global",
      ],
      "services": Array [],
      "sudoExpiresOn": undefined,
      "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36",
      "userId": "1hJNx2XBX94T64w931jVBp",
    },
    Object {
      "_class": Array [
        "AccessKey",
      ],
      "_key": "fastly-api-token:6cw4NpEw9wWDeDkhDFzAEq",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "created_at": "2020-08-29T14:35:06Z",
            "customer_id": "6Bfjl1cR8HV2hPuQykFxJa",
            "expires_at": null,
            "id": "6cw4NpEw9wWDeDkhDFzAEq",
            "ip": "99.29.119.164",
            "last_used_at": "2020-08-29T19:22:25Z",
            "name": "manage.fastly.com browser session",
            "scope": "global",
            "scopes": Array [
              "global",
            ],
            "service_id": null,
            "services": Array [],
            "sudo_expires_at": "2020-08-29T18:27:19Z",
            "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36",
            "user_id": "1hJNx2XBX94T64w931jVBp",
          },
        },
      ],
      "_type": "fastly_api_token",
      "createdOn": 1598711706000,
      "displayName": "manage.fastly.com browser session",
      "expiresOn": undefined,
      "id": "6cw4NpEw9wWDeDkhDFzAEq",
      "ip": "99.29.119.164",
      "lastUsedAt": "99.29.119.164",
      "lastUsedBy": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36",
      "lastUsedOn": 1598728945000,
      "name": "manage.fastly.com browser session",
      "scope": "global",
      "scopes": Array [
        "global",
      ],
      "services": Array [],
      "sudoExpiresOn": 1598725639000,
      "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36",
      "userId": "1hJNx2XBX94T64w931jVBp",
    },
    Object {
      "_class": Array [
        "AccessKey",
      ],
      "_key": "fastly-api-token:7B77tg0OSKAnEHtEzwcaJp",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "created_at": "2020-08-29T14:43:33Z",
            "customer_id": "6Bfjl1cR8HV2hPuQykFxJa",
            "expires_at": null,
            "id": "7B77tg0OSKAnEHtEzwcaJp",
            "ip": "99.29.119.164",
            "last_used_at": "2020-08-29T20:55:20Z",
            "name": "J1",
            "scope": "global:read",
            "scopes": Array [
              "global:read",
            ],
            "service_id": null,
            "services": Array [],
            "sudo_expires_at": null,
            "user_agent": "axios/0.19.2",
            "user_id": "1hJNx2XBX94T64w931jVBp",
          },
        },
      ],
      "_type": "fastly_api_token",
      "createdOn": 1598712213000,
      "displayName": "J1",
      "expiresOn": undefined,
      "id": "7B77tg0OSKAnEHtEzwcaJp",
      "ip": "99.29.119.164",
      "lastUsedAt": "99.29.119.164",
      "lastUsedBy": "axios/0.19.2",
      "lastUsedOn": 1598734520000,
      "name": "J1",
      "scope": "global:read",
      "scopes": Array [
        "global:read",
      ],
      "services": Array [],
      "sudoExpiresOn": undefined,
      "userAgent": "axios/0.19.2",
      "userId": "1hJNx2XBX94T64w931jVBp",
    },
    Object {
      "_class": Array [
        "Service",
      ],
      "_key": "fastly-service:3EgDEph9cJ5gjzE2WHgDCw",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "comment": "",
            "created_at": "2020-08-29T14:35:22Z",
            "customer_id": "6Bfjl1cR8HV2hPuQykFxJa",
            "id": "3EgDEph9cJ5gjzE2WHgDCw",
            "name": "FastTest",
            "type": "vcl",
            "updated_at": "2020-08-29T14:41:22Z",
            "version": 2,
            "versions": Array [
              Object {
                "active": false,
                "comment": "",
                "created_at": "2020-08-29T14:35:22Z",
                "deleted_at": null,
                "deployed": false,
                "locked": false,
                "number": 1,
                "service_id": "3EgDEph9cJ5gjzE2WHgDCw",
                "staging": false,
                "testing": false,
                "updated_at": "2020-08-29T17:16:36Z",
              },
              Object {
                "active": false,
                "comment": "",
                "created_at": "2020-08-29T15:03:03Z",
                "deleted_at": null,
                "deployed": false,
                "locked": true,
                "number": 2,
                "service_id": "3EgDEph9cJ5gjzE2WHgDCw",
                "staging": false,
                "testing": false,
                "updated_at": "2020-08-29T17:15:14Z",
              },
            ],
          },
        },
      ],
      "_type": "fastly_service",
      "category": Array [
        "infrastructure",
      ],
      "createdOn": 1598711722000,
      "description": "",
      "displayName": "FastTest",
      "id": "3EgDEph9cJ5gjzE2WHgDCw",
      "name": "FastTest",
      "updatedOn": 1598712082000,
      "version": 2,
    },
    Object {
      "_class": Array [
        "ApplicationEndpoint",
      ],
      "_key": "fastly-service-backend:null:13.249.40.78:443",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "address": "13.249.40.78",
            "auto_loadbalance": false,
            "between_bytes_timeout": 10000,
            "client_cert": null,
            "comment": "",
            "connect_timeout": 1000,
            "created_at": "2020-08-29T14:40:12Z",
            "deleted_at": null,
            "error_threshold": 0,
            "first_byte_timeout": 15000,
            "healthcheck": null,
            "hostname": null,
            "ipv4": "13.249.40.78",
            "ipv6": null,
            "locked": true,
            "max_conn": 200,
            "max_tls_version": null,
            "min_tls_version": null,
            "name": "Host 1",
            "override_host": null,
            "port": 443,
            "request_condition": "",
            "service_id": "3EgDEph9cJ5gjzE2WHgDCw",
            "shield": "",
            "ssl_ca_cert": null,
            "ssl_cert_hostname": null,
            "ssl_check_cert": false,
            "ssl_ciphers": null,
            "ssl_client_cert": null,
            "ssl_client_key": null,
            "ssl_hostname": null,
            "ssl_sni_hostname": null,
            "updated_at": "2020-08-29T15:03:03Z",
            "use_ssl": true,
            "version": 2,
            "weight": 100,
          },
        },
      ],
      "_type": "fastly_service_backend",
      "address": "13.249.40.78",
      "autoLoadbalance": false,
      "betweenBytesTimeout": 10000,
      "comment": "",
      "connectTimeout": 1000,
      "createdAt": "2020-08-29T14:40:12Z",
      "createdOn": 1598712012000,
      "deletedOn": undefined,
      "description": "",
      "displayName": "Host 1",
      "errorThreshold": 0,
      "firstByteTimeout": 15000,
      "ipAddress": "13.249.40.78",
      "ipv4": "13.249.40.78",
      "locked": true,
      "maxConn": 200,
      "name": "Host 1",
      "port": 443,
      "requestCondition": "",
      "serviceId": "3EgDEph9cJ5gjzE2WHgDCw",
      "shield": "",
      "sslCheckCert": false,
      "updatedAt": "2020-08-29T15:03:03Z",
      "updatedOn": 1598713383000,
      "useSsl": true,
      "version": 2,
      "weight": 100,
    },
    Object {
      "_class": Array [
        "Service",
      ],
      "_key": "fastly-service:5pqQ8jn0OPmRASXrwpmiID",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "comment": "",
            "created_at": "2020-08-27T13:35:17Z",
            "customer_id": "6Bfjl1cR8HV2hPuQykFxJa",
            "id": "5pqQ8jn0OPmRASXrwpmiID",
            "name": "Unnamed Service",
            "type": "vcl",
            "updated_at": "2020-08-27T13:35:17Z",
            "version": 1,
            "versions": Array [
              Object {
                "active": false,
                "comment": "",
                "created_at": "2020-08-27T13:35:17Z",
                "deleted_at": null,
                "deployed": false,
                "locked": false,
                "number": 1,
                "service_id": "5pqQ8jn0OPmRASXrwpmiID",
                "staging": false,
                "testing": false,
                "updated_at": "2020-08-27T13:35:17Z",
              },
            ],
          },
        },
      ],
      "_type": "fastly_service",
      "category": Array [
        "infrastructure",
      ],
      "createdOn": 1598535317000,
      "description": "",
      "displayName": "Unnamed Service",
      "id": "5pqQ8jn0OPmRASXrwpmiID",
      "name": "Unnamed Service",
      "updatedOn": 1598535317000,
      "version": 1,
    },
  ],
  "collectedRelationships": Array [
    Object {
      "_class": "HAS",
      "_fromEntityKey": "fastly-account:6Bfjl1cR8HV2hPuQykFxJa",
      "_key": "fastly-account:6Bfjl1cR8HV2hPuQykFxJa|has|fastly-user:1hJNx2XBX94T64w931jVBp",
      "_toEntityKey": "fastly-user:1hJNx2XBX94T64w931jVBp",
      "_type": "fastly_account_has_user",
      "displayName": "HAS",
    },
    Object {
      "_class": "HAS",
      "_fromEntityKey": "fastly-user:1hJNx2XBX94T64w931jVBp",
      "_key": "fastly-user:1hJNx2XBX94T64w931jVBp|has|fastly-api-token:4sPcKZXcDLkMy3aoVwWeqT",
      "_toEntityKey": "fastly-api-token:4sPcKZXcDLkMy3aoVwWeqT",
      "_type": "fastly_user_has_api_token",
      "displayName": "HAS",
    },
    Object {
      "_class": "HAS",
      "_fromEntityKey": "fastly-user:1hJNx2XBX94T64w931jVBp",
      "_key": "fastly-user:1hJNx2XBX94T64w931jVBp|has|fastly-api-token:6cw4NpEw9wWDeDkhDFzAEq",
      "_toEntityKey": "fastly-api-token:6cw4NpEw9wWDeDkhDFzAEq",
      "_type": "fastly_user_has_api_token",
      "displayName": "HAS",
    },
    Object {
      "_class": "HAS",
      "_fromEntityKey": "fastly-user:1hJNx2XBX94T64w931jVBp",
      "_key": "fastly-user:1hJNx2XBX94T64w931jVBp|has|fastly-api-token:7B77tg0OSKAnEHtEzwcaJp",
      "_toEntityKey": "fastly-api-token:7B77tg0OSKAnEHtEzwcaJp",
      "_type": "fastly_user_has_api_token",
      "displayName": "HAS",
    },
    Object {
      "_class": "HAS",
      "_fromEntityKey": "fastly-account:6Bfjl1cR8HV2hPuQykFxJa",
      "_key": "fastly-account:6Bfjl1cR8HV2hPuQykFxJa|has|fastly-service:3EgDEph9cJ5gjzE2WHgDCw",
      "_toEntityKey": "fastly-service:3EgDEph9cJ5gjzE2WHgDCw",
      "_type": "fastly_account_has_service",
      "displayName": "HAS",
    },
    Object {
      "_class": "HAS",
      "_fromEntityKey": "fastly-service:3EgDEph9cJ5gjzE2WHgDCw",
      "_key": "fastly-service:3EgDEph9cJ5gjzE2WHgDCw|has|fastly-service-backend:null:13.249.40.78:443",
      "_toEntityKey": "fastly-service-backend:null:13.249.40.78:443",
      "_type": "fastly_service_has_backend",
      "displayName": "HAS",
    },
    Object {
      "_class": "CONNECTS",
      "_key": "fastly-service-backend:null:13.249.40.78:443|connects|FORWARD:_class=Host,Gateway:ipAddress=13.249.40.78:_class=Host,Gateway:hostname=null",
      "_mapping": Object {
        "relationshipDirection": "FORWARD",
        "skipTargetCreation": true,
        "sourceEntityKey": "fastly-service-backend:null:13.249.40.78:443",
        "targetEntity": Object {
          "_class": Array [
            "Host",
            "Gateway",
          ],
          "hostname": null,
          "ipAddress": "13.249.40.78",
        },
        "targetFilterKeys": Array [
          Array [
            "_class",
            "ipAddress",
          ],
          Array [
            "_class",
            "hostname",
          ],
        ],
      },
      "_type": "fastly_service_backend_connects_host",
      "displayName": "CONNECTS",
    },
    Object {
      "_class": "CONNECTS",
      "_key": "fastly-service:3EgDEph9cJ5gjzE2WHgDCw|connects|FORWARD:_class=DomainRecord:name=jupiterone.com",
      "_mapping": Object {
        "relationshipDirection": "FORWARD",
        "sourceEntityKey": "fastly-service:3EgDEph9cJ5gjzE2WHgDCw",
        "targetEntity": Object {
          "_class": "DomainRecord",
          "name": "jupiterone.com",
        },
        "targetFilterKeys": Array [
          Array [
            "_class",
            "name",
          ],
        ],
      },
      "_type": "fastly_service_connects_domain_record",
      "createdOn": 1598711735000,
      "deletedOn": undefined,
      "description": "",
      "displayName": "CONNECTS",
      "locked": true,
      "updatedOn": 1598713383000,
    },
    Object {
      "_class": "CONNECTS",
      "_key": "fastly-service:3EgDEph9cJ5gjzE2WHgDCw|connects|FORWARD:_class=DomainRecord:name=securitymanifesto.net",
      "_mapping": Object {
        "relationshipDirection": "FORWARD",
        "sourceEntityKey": "fastly-service:3EgDEph9cJ5gjzE2WHgDCw",
        "targetEntity": Object {
          "_class": "DomainRecord",
          "name": "securitymanifesto.net",
        },
        "targetFilterKeys": Array [
          Array [
            "_class",
            "name",
          ],
        ],
      },
      "_type": "fastly_service_connects_domain_record",
      "createdOn": 1598711800000,
      "deletedOn": undefined,
      "description": "",
      "displayName": "CONNECTS",
      "locked": true,
      "updatedOn": 1598713383000,
    },
    Object {
      "_class": "HAS",
      "_fromEntityKey": "fastly-account:6Bfjl1cR8HV2hPuQykFxJa",
      "_key": "fastly-account:6Bfjl1cR8HV2hPuQykFxJa|has|fastly-service:5pqQ8jn0OPmRASXrwpmiID",
      "_toEntityKey": "fastly-service:5pqQ8jn0OPmRASXrwpmiID",
      "_type": "fastly_account_has_service",
      "displayName": "HAS",
    },
  ],
  "encounteredTypes": Array [
    "fastly_account",
    "fastly_user",
    "fastly_account_has_user",
    "fastly_api_token",
    "fastly_user_has_api_token",
    "fastly_service",
    "fastly_account_has_service",
    "fastly_service_backend",
    "fastly_service_has_backend",
    "fastly_service_backend_connects_host",
    "fastly_service_connects_domain_record",
  ],
  "numCollectedEntities": 8,
  "numCollectedRelationships": 10,
}
`;
